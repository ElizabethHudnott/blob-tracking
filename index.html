<!DOCTYPE html>
<html>
<head>
	<script src="lib/convex-hull.js" defer></script>
	<script src="blob-tracking.js" defer></script>
	<title>Blob Tracking</title>
	<style>
		.form-control-range {
			width:  640px;
		}
	</style>
</head>
<body>
	<video id="webcam" autoplay hidden></video>
	<canvas id="canvas"></canvas>
	<table>
		<tr>
			<td>Display</td>
			<td>
				<select id="camera-display">
					<option value="1">Camera</option>
					<option value="2">Background Subtraction</option>
					<option value="3">Colour Key</option>
					<option value="4">Blobs</option>
					<option value="5">Motion Tracker</option>
				</select>
				<button type="button" id="camera-activation">Start</button>
			</td>
		</tr>
		<tr>
			<td>Key Colour</td>
			<td>
				<input type="color" id="color-keying" value="#00ff00">
				<input type="checkbox" id="subtract-background">
				<label for="subtract-background">Exclude background</label>
			</td>
		</tr>
		<tr>
			<td>Hue</td>
			<td colspan="3">
				<input type="range" min="0" max="765" value="382" id="hue-threshold" class="form-control-range">
			</td>
		</tr>
		<tr>
			<td>Saturation</td>
			<td colspan="3">
				<input type="range" min="0" max="255" value="128" id="saturation-threshold" class="form-control-range">
			</td>
		</tr>
		<tr>
			<td>Intensity</td>
			<td colspan="3">
				<input type="range" min="0" max="765" value="382" id="intensity-threshold" class="form-control-range">
			</td>
		</tr>
		<tr>
			<td>Max Point to Blob Distance</td>
			<td>
				<input type="number" min="1" max="100" value="20" id="blob-distance">
			</td>
			<td>Blob Boundary Percentile</td>
			<td>
				<input type="number" min="51" max="100" value="90" id="blob-boundary-percentile">
			</td>
		</tr>
		<tr>
			<td>Min Points in a Blob</td>
			<td>
				<input type="number" min="10" max="999990" step="50" value="800" id="min-blob-points">
			</td>
			<td>Max Blob TTL</td>
			<td>
				<input type="number" min="1"  max="999" value="100" id="max-blob-ttl">
			</td>
		</tr>
		<tr>
			<td>Motion Threshold</td>
			<td>
				<input type="number" min="1" max="255" value="25" id="motion-threshold">
			</td>
		</tr>
	</table>

	<ol>
		<li>
			Make sure the room is well lit. If you can then use a third party application to disable your camera's auto white balance feature and tweak the brightness, contrast, etc. to get the clearest picture. Then exit the other program and click <b>Start</b> here.
		</li>
		<li>
			Move the items you want to track (e.g. your body) out of range of the camera and press the space bar.
		</li>
		<li>
			Put the items you want to track back into the picture.
		</li>
		<li>
			Select <b>Background Subtraction</b> from the <b>Display</b> list.
		</li>
		<li>
			Reduce the <b>Intensity</b> threshold. Try to expose the items you want to keep track of as much as possible. This is the top priority. But if you can then also try keep as much of the background as possible green. Do the same with the <b>Saturation</b> and <b>Hue</b> sliders.
		</li>
		<li>
			Select <b>Camera</b> from the <b>Display</b> list.
		</li>
		<li>
			Click on a part of the image that contains the colour of the objects that you wish to track (e.g. your skin tone).
		</li>
		<li>
			Tick the <b>Exclude Background</b> box.
		</li>
		<li>
			Adjust the <b>Hue</b>, <b>Saturation</b> and <b>Intensity</b> sliders until you've covered up as much as possible of the items you want track and removed as much green as possible from the background.
		</li>
		<li>
			Select <b>Blobs</b> from the <b>Display List</b>.
		</li>
		<li>
			Alter <b>Max Point to Blob Distance, Min Points in a Blob</b> and <b>Blob Boundary Percentile</b> if needed.
		</li>
	</ol>
	<ul>
		<li>
			If you switch to another tab or another application then the image will disappear to conserve CPU and battery. Press <b>Start</b> to pick up where you left off.
		</li>
	</ul>
</body>
</html>
